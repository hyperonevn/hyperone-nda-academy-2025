<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=0.7, maximum-scale=1.0">
<title>Cam Káº¿t Báº£o Máº­t ThÃ´ng Tin â€“ HYPER ONE</title>
<style>
:root {
  --ink:#0f172a; --muted:#334155; --line:#e2e8f0;
}
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html,body{
  margin:0;padding:0;
  font:12px/1.65 "Times New Roman",serif;
  color:var(--ink);background:#fff;
}
.wrap{display:flex;justify-content:center;padding:12px;}
.sheet{
  width:100%;max-width:794px;
  border:1px solid var(--line);
  padding:28px 40px;
}
.header{text-align:center;position:relative;margin-bottom:24px;}
.header img{
  position:absolute;top:0;right:0;width:70px;height:70px;object-fit:contain;
}
.header b{display:block;font-size:14px;text-transform:uppercase;}
.header span{display:block;font-size:12px;}
.header hr{width:180px;margin:5px auto;border:0;border-top:1px solid #000;}
.title{
  text-transform:uppercase;
  font-weight:700;
  font-size:13.5px;
  margin-top:6px;
}
.box{
  border:1px dashed var(--line);
  padding:10px 14px;
  border-radius:6px;
  margin-bottom:12px;
}
.label{font-weight:600;color:var(--muted);margin-top:6px;}
input{
  width:100%;
  padding:6px 8px;
  border:1px solid var(--line);
  border-radius:6px;
  font-size:12px;
}
.course-preview{
  border:1px solid var(--line);
  border-radius:6px;
  text-align:center;
  font-weight:700;
  padding:5px;
  margin-top:5px;
}
.hr{height:1px;background:var(--line);margin:18px 0;}
.signers{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  flex-wrap:nowrap;
  gap:10px;
}
.sign-card{
  width:49%;
  border:1px solid var(--line);
  border-radius:8px;
  padding:10px;
  text-align:center;
}
.sign-title{font-weight:700;font-size:12.5px;margin-bottom:2px;}
.subtitle-muted{color:var(--muted);font-size:11.5px;}
.role-strong{font-weight:800;font-size:12.5px;margin-top:2px;}
.sig-image{width:150px;margin:8px 0;}
.sign-pad{
  border:1px solid var(--line);
  border-radius:8px;
  width:100%;height:100px;
  background:#fff;
  touch-action:none;
  display:block;
  image-rendering:pixelated;
  -webkit-print-color-adjust: exact;
  print-color-adjust: exact;
  margin-top:10px;
  margin-bottom:60px; /* âœ… Ä‘á»ƒ trá»‘ng khoáº£ng 10 dÃ²ng dÆ°á»›i khung chá»¯ kÃ½ */
}
.sig-label{margin-top:6px;font-size:11.5px;}
.sig-name-strong{font-weight:800;margin-top:4px;font-size:11.5px;}
.sign-caption{font-size:11px;color:var(--muted);}
@media(max-width:420px){
  .sheet{padding:16px;}
  .signers{gap:6px;}
  .sign-card{width:49%;padding:6px;}
  .sig-image{width:120px;}
  .sign-pad{height:90px;margin-bottom:50px;}
  html,body{font-size:11px;}
}
</style>
</head>
<body>
<div class="wrap">
  <div class="sheet" id="nda-sheet">
    <div class="header">
      <img src="https://raw.githubusercontent.com/hyperonevn/hyperone-nda-academy-2025/main/hyperone-logo.png" alt="Logo HYPER ONE">
      <b>Cá»˜NG HÃ’A XÃƒ Há»˜I CHá»¦ NGHÄ¨A VIá»†T NAM</b>
      <span>Äá»™c láº­p - Tá»± do - Háº¡nh phÃºc</span>
      <hr>
      <div class="title">CAM Káº¾T Báº¢O Máº¬T THÃ”NG TIN</div>
    </div>

    <div class="box">
      <b>THÃ”NG TIN BÃŠN A â€“ CÃ”NG TY TNHH HYPER ONE</b>
      <p><b>TÃªn doanh nghiá»‡p:</b> CÃ”NG TY TNHH HYPER ONE</p>
      <p><b>MST:</b> 0318921926</p>
      <p><b>Äá»‹a chá»‰:</b> 68 Nguyá»…n Huá»‡, PhÆ°á»ng SÃ i GÃ²n, TP.HCM.</p>
      <p><b>Äáº¡i diá»‡n:</b> Lá»¯ Minh TrÃ­ â€“ <b>GiÃ¡m Äá»‘c</b></p>
    </div>

    <div class="box">
      <b>THÃ”NG TIN BÃŠN B â€“ Há»ŒC VIÃŠN / KHÃCH Má»œI</b><br>
      <label class="label" style="margin-top:8px;">Há» vÃ  tÃªn</label>
      <input id="stu_name" placeholder="Nháº­p há» tÃªn">
      <label class="label">Email</label>
      <input id="stu_email" type="email" placeholder="example@email.com">
      <label class="label">Sá»‘ Ä‘iá»‡n thoáº¡i</label>
      <input id="stu_phone" type="tel" placeholder="0xxxxxxxxx">
      <label class="label">TÃªn khÃ³a há»c</label>
      <div class="course-preview"><b>Practical AI for Working Professionals</b></div>
      <label class="label">NgÃ y kÃ½</label>
      <input id="sign_date" type="date" style="font-weight:bold;">
    </div>

    <div class="hr"></div>
    <div id="content-section">Äang táº£i ná»™i dung...</div>
    <div class="hr"></div>

    <div class="signers">
      <div class="sign-card">
        <div class="sign-title">BÃŠN A â€“ CÃ”NG TY TNHH HYPER ONE</div>
        <div class="subtitle-muted">Äáº¡i diá»‡n theo phÃ¡p luáº­t</div>
        <div class="role-strong">GIÃM Äá»C</div>
        <img class="sig-image" src="https://raw.githubusercontent.com/hyperonevn/hyperone-nda-academy-2025/main/luminhtri.jpg" alt="Chá»¯ kÃ½ Lá»¯ Minh TrÃ­">
        <div class="sig-name-strong" style="text-align:center;">Lá»® MINH TRÃ</div>
        <div class="sign-caption">(ÄÃ£ kÃ½ vÃ  Ä‘Ã³ng dáº¥u)</div>
      </div>

      <div class="sign-card">
        <div class="sign-title">BÃŠN B â€“ Há»ŒC VIÃŠN / KHÃCH Má»œI</div>
        <div class="subtitle-muted">NgÆ°á»i kÃ½</div>
        <div class="role-strong">Há»ŒC VIÃŠN</div>
        <div class="sig-label">Chá»¯ kÃ½:</div>
        <canvas id="padB" class="sign-pad"></canvas>
        <div class="sign-caption">KÃ½ trá»±c tiáº¿p (chuá»™t/cáº£m á»©ng)</div>
        <div class="sig-name-strong" id="stu_sign_name" style="text-align:center;">Há»Œ TÃŠN Há»ŒC VIÃŠN</div>
      </div>
    </div>

    <div style="text-align:center;margin-top:24px;">
      <button id="btnClearSign" style="border:1px solid #e2e8f0;background:#fff;padding:10px 20px;border-radius:6px;font-size:13px;cursor:pointer;margin-right:12px;">ğŸ§¹ XÃ³a chá»¯ kÃ½</button>
      <button id="btnExport" style="border:1px solid #2563eb;background:#2563eb;color:#fff;padding:10px 20px;border-radius:6px;font-size:13px;cursor:pointer;">ğŸ’¾ LÆ°u PDF</button>
    </div>
  </div>
</div>

<!-- jsPDF + html2canvas -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<script>
// === Load ná»™i dung ===
fetch("content.html").then(r=>r.text()).then(t=>document.getElementById("content-section").innerHTML=t);

// === GÃ¡n ngÃ y hiá»‡n táº¡i máº·c Ä‘á»‹nh ===
const dateInput=document.getElementById('sign_date');
if(!dateInput.value){
  const now=new Date();
  const y=now.getFullYear(),m=String(now.getMonth()+1).padStart(2,'0'),d=String(now.getDate()).padStart(2,'0');
  dateInput.value=`${y}-${m}-${d}`;
}

// === Äá»“ng bá»™ há» tÃªn há»c viÃªn xuá»‘ng chá»¯ kÃ½ ===
const nameInput=document.getElementById('stu_name');
const stuSignName=document.getElementById('stu_sign_name');
function syncName(){
  const val=nameInput.value.trim();
  stuSignName.textContent=val?val.toUpperCase():'Há»Œ TÃŠN Há»ŒC VIÃŠN';
}
nameInput.addEventListener('input',syncName);
syncName();

// === Canvas kÃ½ ===
function makePad(c){
  const ctx=c.getContext('2d');
  let drawing=false,prev=null;
  const DPR=1.5; // trÃ¡nh lá»—i sá»c Ä‘en Retina
  function resize(){
    c.width=c.clientWidth*DPR;c.height=c.clientHeight*DPR;
    ctx.setTransform(DPR,0,0,DPR,0,0);
    ctx.lineWidth=1.5;ctx.lineCap='round';ctx.strokeStyle='#111827';
  }
  resize();window.addEventListener('resize',resize);
  function pos(e){if(e.touches&&e.touches[0])e=e.touches[0];
    const r=c.getBoundingClientRect();return{x:e.clientX-r.left,y:e.clientY-r.top};}
  c.addEventListener('mousedown',e=>{drawing=true;prev=pos(e);});
  c.addEventListener('mousemove',e=>{if(!drawing)return;const p=pos(e);
    ctx.beginPath();ctx.moveTo(prev.x,prev.y);ctx.lineTo(p.x,p.y);ctx.stroke();prev=p;});
  window.addEventListener('mouseup',()=>drawing=false);
  c.addEventListener('touchstart',e=>{drawing=true;prev=pos(e);e.preventDefault();},{passive:false});
  c.addEventListener('touchmove',e=>{if(!drawing)return;const p=pos(e);
    ctx.beginPath();ctx.moveTo(prev.x,prev.y);ctx.lineTo(p.x,p.y);ctx.stroke();
    prev=p;e.preventDefault();},{passive:false});
  window.addEventListener('touchend',()=>drawing=false);
  return {clear:()=>ctx.clearRect(0,0,c.width,c.height)};
}
const padB=makePad(document.getElementById('padB'));

// === XÃ³a chá»¯ kÃ½ ===
document.getElementById('btnClearSign').addEventListener('click',()=>padB.clear());

// === Xuáº¥t PDF ===
document.getElementById('btnExport').addEventListener('click',async()=>{
  const sheet=document.getElementById('nda-sheet');
  const { jsPDF } = window.jspdf;
  const canvas=await html2canvas(sheet,{
    useCORS:true,
    scale:2,
    backgroundColor:'#fff',
    scrollY:0,
    scrollX:0,
    windowWidth:document.documentElement.offsetWidth,
    windowHeight:document.documentElement.scrollHeight
  });
  const imgData=canvas.toDataURL('image/jpeg',1.0);
  const pdf=new jsPDF('p','pt','a4');
  const pageWidth=pdf.internal.pageSize.getWidth();
  const pageHeight=pdf.internal.pageSize.getHeight();
  const imgWidth=pageWidth;
  const imgHeight=canvas.height*imgWidth/canvas.width;
  let heightLeft=imgHeight;let position=0;

  pdf.setFillColor(255,255,255);
  pdf.rect(0,0,pageWidth,pageHeight,'F');
  pdf.addImage(imgData,'JPEG',0,position,imgWidth,imgHeight);
  heightLeft-=pageHeight;
  while(heightLeft>0){
    position=heightLeft-imgHeight;
    pdf.addPage();
    pdf.setFillColor(255,255,255);
    pdf.rect(0,0,pageWidth,pageHeight,'F');
    pdf.addImage(imgData,'JPEG',0,position,imgWidth,imgHeight);
    heightLeft-=pageHeight;
  }

  // âœ… TÃªn file gá»“m tÃªn há»c viÃªn + ngÃ y kÃ½
  const name=(nameInput.value||'HocVien').trim().replace(/\s+/g,'_');
  const date=(dateInput.value||new Date().toISOString().slice(0,10)).replace(/-/g,'');
  pdf.save(`CamKetBaoMat_HYPERONE_${name}_${date}.pdf`);
});
</script>
</body>
</html>
